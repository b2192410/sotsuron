# はじめに
このdatabase_utilitiesはJavaにおいて、JDBCと[HikariCP](https://github.com/brettwooldridge/HikariCP)
を用いたデータベース利用を想定した場合の支援を目的としたライブラリです。

# 使い方
## 概要
このライブラリを用いることで、データベースを利用するために必要なクラスは以下の四つになる。

1. データソースの管理クラス
2. SQLクエリの管理クラス
3. SQLクエリの実行結果を保存するクラス
4. 三項目目のクラスにマッピングするためのクラス

この内、マッピングするためのクラスはライブラリ内のAutoMapperを利用することで省略が可能である。  
各クラスの実装方法を以下に示したため、参考にしてほしい。

## 1.データソースの管理クラス
データソースの管理クラスでは、データベースを利用するための設定の読み込みと、
シングルストンデザインパターンを用いた実装を行う。  
まず、データベースを利用するため設定はpropertiesファイルを用いて行う。  
設定方法は[HikariCPのドキュメント](https://github.com/brettwooldridge/HikariCP#rocket-initialization)
や、exampleプロジェクト内のworld.propertiesファイルを参考にしてほしい。

次に、データソースの管理クラスの実装を行う。  
このクラスを実装する際には、IDataSourceManagerインタフェースを実装する。 
この時、クラスの名称は対象のデータベースの名称の後にManagerをつなげることが望ましい。  
また、先に述べたようにこのクラスはシングルストンデザインパターンを用いて実装する。
実際に実装を行った例は、exampleプロジェクト内のWorldManager.javaを参考にしてほしい。

## 2.SQLクエリの管理クラス
SQLクエリの管理クラスでは、データベースのテーブル毎に必要なクエリをそれぞれメソッドとして実装する。
この時、クラスの名称は対象のテーブル名の後にQueriesをつなげることが望ましい。  
また、一つのメソッドにつき一つのSQL文の実行を行う。  
SQL文の実行のために、このライブラリのQueryManagerクラスを利用する。  
このクラスを利用した場合、開発者は以下の三項目を実装する必要がある。  

1. 実行するSQL文
2. SQL文の実行(ここでQueryManagerクラスを利用する)
3. 戻り値に応じたマッピング処理

また、QueryManagerクラスはプライベートフィールドにてインスタンス化を行う。  
この時、インスタンス化の引数として対象のデータソースの管理クラスを渡す必要がある。  
実際に実装を行った例は、exampleプロジェクト内のCityQueries.javaを参考にしてほしい。

## 3.SQLクエリの実行結果を保存するクラス
SQLクエリの実行結果を保存するクラスでは、先のクエリの管理クラスで実行した結果を保存する。  
このクラスの名称は、対象のテーブル名の後にEntityをつなげることが望ましい。  
また、このクラスはレコード・クラスとなる。  
Javaのバージョンが高い場合はこれを用いて実装することで、実装が容易となる。  
手動で実装を行う場合には、exampleプロジェクト内のCityEntity.javaを参考にしてほしい。

## 4. 三項目目のクラスにマッピングするためのクラス
マッピングするためのクラスでは、QueryManagerクラスを利用した際の戻り値であるResultSetManagerクラスと、
実行結果を保存するクラス間のマッピングを行う。
このクラスを実装する際には、IResultSetMapperインタフェースを実装する必要がある。  
実査に実装を行った例は、exampleプロジェクト内のCityMapper.javaを参考にしてほしい。